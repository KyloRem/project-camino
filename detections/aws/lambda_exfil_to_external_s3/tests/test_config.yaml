# Test configuration for detection validation
# Defines mock values for macros and lookups
# Use this to test unique variables don't scale well across organizations.

macros:
  "aws cloudtrail":
    index: "aws"
    sourcetype: "aws:cloudtrail"

lookups:
  aws_accounts_allowed:
    # accountId: accountName
    # Accounts listed here are "known good" - should NOT trigger alerts
    "111111111111": "internal-prod"
    "222222222222": "internal-dev"
    # Note: 999999999999 is intentionally absent (simulates external/unknown account)

conditions:
  - field: "eventName"
    operator: "in"
    values: ["PutObject", "CopyObject"]
  - field: "userIdentity.type"
    operator: "equals"
    value: "AssumedRole"
  - field: "userIdentity.invokedBy"
    operator: "contains"
    value: "lambda.amazonaws.com"
  - field: "userIdentity.accountId"
    operator: "not_equals_field"
    other_field: "resources[0].accountId"
  - field: "resources[0].accountId"
    operator: "not_in_lookup"
    lookup: "aws_accounts_allowed"
